DIAGNOS
 str_replace(DIAGNOS, "^ ", "" )
factor( str_replace(DIAGNOS, "^ ", "" ))
factor( str_replace(DIAGNOS, "^ ", "" ))$levels
factor( str_replace(DIAGNOS, "^ ", "" ))$level
factor( str_replace(DIAGNOS, "^ ", "" ))$levels
levels (factor( str_replace(DIAGNOS, "^ ", "" )))
factor( str_replace(DIAGNOS, "^ ", "" ), levels=c("GI", "Isolerad feber", "Luftvägssymtom", "Luftvägssymtom+UVI", "UVI" ))
data$Diagnos = factor( str_replace(DIAGNOS, "^ ", "" ), levels=c("GI", "Isolerad feber", "Luftvägssymtom", "Luftvägssymtom+UVI", "UVI" ))
pie( table(data$Diagnos), col=rainbow(7))
table(data$Diagnos) / sum( table(data$Diagnos) ) * 100
round(table(data$Diagnos) / sum( table(data$Diagnos) ) * 100,2)
round(table(data$Diagnos) / sum( table(data$Diagnos) ) * 100,1)
plot(as.numeric(as.character(data$Fråga..9) ~ data$Åldern )
plot(as.numeric(as.character(data$Fråga..9)) ~ data$Åldern )
plot(as.numeric(as.character(data$Fråga..9)) ~ data$Åldern , main='Fråga..9', xlab='', ylab='')
plot(as.numeric(as.character(data$Fråga..9)) ~ data$Åldern , main='Fråga 9', xlab='', ylab='')
result_table <- function (column,  crp=T) {
t <- NULL
for ( n in levels(data[,column]) ) {
t = rbind(t, median_mad_age ( column, n, crp ))
}
colnames(t) <- c( 'median', 'mad' )
rownames(t) <- levels(data[,column])
t
}
result_table ( 'Fråga..9' )
levels(data[,'Fråga..9'])
lables(data[,'Fråga..9'])
lable(data[,'Fråga..9'])
?factor
labels(data[,'Fråga..9'])
levels(data[,'Fråga..9'])
levels(data[,'Åldern'])
result_table <- function (column,  crp=T) {
t <- NULL
for ( n in levels(data[,'Åldern']) ) {
t = rbind(t, median_mad_age ( column, n, crp ))
}
colnames(t) <- c( 'median', 'mad' )
rownames(t) <- levels(data[,'Åldern'])
t
}
result_table ( 'Fråga..9' )
median_mad_age <- function( column, age, crp=T ) {
if ( crp ) {
ids <- which(data[,'Åldern'] == age & data[,'CRP'] )
}else{
ids <- which(data[,'Åldern'] == age & data[,'STREP'] )
}
#browser()
m = median( as.numeric(as.character( data[ids,column] )))
s = mad ( as.numeric(as.character( data[ids,column] )))
c (m , s)
}
result_table ( 'Fråga..9' )
result_table ( 'Fråga..10' )
colnames(data)
plot(data$kön ~ data$Åldern )
boxplot(data$kön ~ data$Åldern )
ls()
table(data$kön , data$Åldern)
ag = table(data$kön , data$Åldern)
ag = ag[-2]
ag
melt(ag)
library(reshape2)
library(reshape)
install.packages('reshape2')
library(reshape2)
melt(ag)
melt(t(ag))
ag
ag = table(data$kön , data$Åldern)
ag = ag[,-2]
ag
melt(ag)
ag_melted = melt(ag)
colnames(ag_melted) <- c('kön', 'Ålder','value')
ag_melted
boxplot(ag_melted)
?boxplot
barplot(ag_melted)
table(mtcars$vs, mtcars$gear)
barplot(mtcars$vs, mtcars$gear)
counts <- table(mtcars$vs, mtcars$gear)
barplot(counts, main="Car Distribution by Gears and VS",
  xlab="Number of Gears", col=c("darkblue","red"),
  legend = rownames(counts), beside=TRUE)
barplot(ag_melted,col=c('red','blue'))
barplot(t(ag_melted),col=c('red','blue'), height)
barplot(t(ag_melted),col=c('red','blue'))
barplot(t(ag_melted$values),col=c('red','blue'))
ag
ag <- ag[,-2]
ag_melted = melt(ag)
colnames(ag_melted) <- c('kön', 'Ålder','value')
ag
ag_melted
ag = table(data$kön , data$Åldern)
ag = ag[-2,]
ag
ag_melted = melt(ag)
library(ggplot2)
install.packages('ggplot2')
library(ggplot2)
ggplot(data=ag_melted, aes(x='Ålder', y='value', fill='kön')
geom_bar(stat="identity", color="black", position=position_dodge())+theme_minimal()
pl = ggplot(data=ag_melted, aes(x='Ålder', y='value', fill='kön')
 +
geom_bar(stat="identity", color="black", position=position_dodge())+
  theme_minimal()
pl = ggplot(data=ag_melted, aes(x='Ålder', y='value', fill='kön')) +
geom_bar(stat="identity", color="black", position=position_dodge())+
theme_minimal()
plot(pl)
p + scale_fill_manual(values=c('#999999','#E69F00'))
pl + scale_fill_manual(values=c('#999999','#E69F00'))
p + scale_fill_brewer(palette="Blues")
pl + scale_fill_brewer(palette="Blues")
ag_melted
colnames(ag_melted) <- c('kön', 'Ålder','value')
pl = ggplot(data=ag_melted, aes(x='Ålder', y='value', fill='kön')) +
geom_bar(stat="identity", color="black", position=position_dodge())+
theme_minimal()
plot8pl)
plot(pl)
ag_melted
ag_melted[,1]
ag_melted[,2]
pl + scale_fill_brewer(palette="Blues")
ag_melted
pl = ggplot(data=ag_melted, aes(x='Ålder', y='value', fill='kön')) +
geom_bar( color="black", position=position_dodge())+
theme_minimal()
pl
aes(x=ag_melted$'Ålder', y=ag_melted$'value', fill=ag_melted$'kön')
ggplot( aes(x=ag_melted$'Ålder', y=ag_melted$'value', fill=ag_melted$'kön')) + 
geom_bar( stat='identity',  position=position_dodge())+  theme_minimal()
ggplot(data=ag_melted, aes(x=ag_melted$'Ålder', y=ag_melted$'value', fill=ag_melted$'kön')) + 
geom_bar( stat='identity',  position=position_dodge())+  theme_minimal()
ggplot(data=ag_melted, aes(x=$'Ålder', y='value', fill='kön')) +
geom_bar( stat='identity',  position=position_dodge())+  theme_minimal()
ggplot(data=ag_melted, aes(x='Ålder', y='value', fill='kön')) +
geom_bar( stat='identity',  position=position_dodge())+  theme_minimal()
pl = ggplot(data=ag_melted, (x=ag_melted$'Ålder', y=ag_melted$'value', fill=ag_melted$'kön') +
geom_bar(stat="identity", color="black", position=position_dodge())+
theme_minimal()
pl = ggplot(data=ag_melted, (x=ag_melted$'Ålder', y=ag_melted$'value', fill=ag_melted$'kön')) +
geom_bar(stat="identity", color="black", position=position_dodge())+
theme_minimal()
pl = ggplot(data=ag_melted, aes (x=ag_melted$'Ålder', y=ag_melted$'value', fill=ag_melted$'kön')) +
geom_bar(stat="identity", color="black", position=position_dodge())+
theme_minimal()
pl
pl + xlab('test
')
pl = pl + xlab('Ålder') + ylab('patient [n]') + labs(fill = "Kön")
pl
pdf(file="Åldersfördelning.pdf", height=6, width=6)
pl
dev.off()
png(file="Åldersfördelning.png", height=800, width=800)
pl
dev.off()
png(file="Åldersfördelning.png", height=600, width=600)
pl
dev.off()
colnamed(data)
colnames(data)
plot(data$Fråga..9 ~ data$Åldern )
ggplot(data, aes(Fråga..9, Åldern ) +geom_boxplot()
ggplot(data, aes(Fråga..9, Åldern )) +geom_boxplot()
ggplot(data, aes( Åldern, Fråga..9 )) +geom_boxplot()
x11()
plot(data$Fråga..9 ~ data$Åldern )
ggplot(data, aes(Fråga..9, Åldern )) +geom_violin()
ggplot(data, aes( Åldern, Fråga..9 )) +geom_violin()
ggplot(data, aes( Åldern, Fråga..9 )) +geom_boxplot()
ggplot(data, aes( Åldern, Fråga..9 )) +geom_boxplot() +ylab('')
Plot = function (p, file ) {
pdf(file=paste(file,'pdf',sep='.'), width=6, height=6)
p
dev.off()
png(file=paste(file,'png',sep='.'), width=600, height=600)
p
dev.off()
}
Plot( pl, 'Åldersfördelning')
dev.off()
Plot( pl, 'Åldersfördelning')
Plot = function (p, file ) {
pdf(file=paste(file,'pdf',sep='.'), width=6, height=6)
print(p)
dev.off()
png(file=paste(file,'png',sep='.'), width=600, height=600)
p
dev.off()
}
Plot( pl, 'Åldersfördelning')
Plot = function (p, file ) {
pdf(file=paste(file,'pdf',sep='.'), width=6, height=6)
print(p)
dev.off()
png(file=paste(file,'png',sep='.'), width=600, height=600)
print(p)
dev.off()
}
Plot( pl, 'Åldersfördelning')
Plot(ggplot(data, aes( Åldern, Fråga..9 )) +geom_boxplot() +ylab(''),
'Question_9_all' )
CRP
CRP <- data[which(data$CRP),]
STREP <- data[which(data$STREP),]
dim(CRP)
dim(STREP)
dim(data)
Plot(ggplot(CRP, aes( Åldern, Fråga..9 )) +geom_boxplot() +ylab(''),
'Question_9_CRP' )
Plot(ggplot(STREP, aes( Åldern, Fråga..9 )) +geom_boxplot() +ylab(''),
'Question_9_STREP' )
Plot = function (p, file ) {
pdf(file=paste("../figures/",file,'.pdf',sep=''), width=6, height=6)
print(p)
dev.off()
png(file=paste("../figures/",file,'.png',sep=''), width=600, height=600)
print(p)
dev.off()
}
Plot( pl, 'Åldersfördelning')
Plot(ggplot(data, aes( Åldern, Fråga..9 )) +geom_boxplot() +ylab(''),
'Question_9_all' )
Plot(ggplot(CRP, aes( Åldern, Fråga..9 )) +geom_boxplot() +ylab(''),
'Question_9_CRP' )
Plot(ggplot(STREP, aes( Åldern, Fråga..9 )) +geom_boxplot() +ylab(''),
'Question_9_STREP' )
Plot(ggplot(data, aes( Åldern, Fråga..10 )) +geom_boxplot() +ylab(''),
'Question_10_all' )
Plot(ggplot(CRP, aes( Åldern, Fråga..10 )) +geom_boxplot() +ylab(''),
'Question_10_CRP' )
Plot(ggplot(STREP, aes( Åldern, Fråga..10 )) +geom_boxplot() +ylab(''),
'Question_10_STREP' )
ggplot(data, aes( Åldern, Fråga..10 )) +geom_boxplot(na.rm = TRUE) +ylab('')
data$Fråga..10
data$data.9 <- as.numeric(as.character(data$Fråga..9))
data$data.10 <- as.numeric(as.character(data$Fråga..10))
CRP <- data[which(data$CRP),]
STREP <- data[which(data$STREP),]
ggplot(data, aes( Åldern, data.9 )) +geom_boxplot() +ylab('')
ggplot(data, aes( Åldern, data.10 )) +geom_boxplot() +ylab('')
Plot(ggplot(data, aes( Åldern, data.10 )) +geom_boxplot(na.rm = TRUE) +ylab(''),
'Question_10_all' )
Plot(ggplot(CRP, aes( Åldern, data.10 )) +geom_boxplot() +ylab(''),
'Question_10_CRP' )
Plot(ggplot(STREP, aes( Åldern, data.10 )) +geom_boxplot() +ylab(''),
'Question_10_STREP' )
pl = ggplot(data=ag_melted, aes (x=ag_melted$'Ålder', y=ag_melted$'value', fill=ag_melted$'kön')) +
geom_bar(stat="identity", color="black", position=position_dodge())+
theme_minimal()
pl = pl + xlab('Ålder') + ylab('patient [n]') + labs(fill = "Kön")
Plot( pl, 'Åldersfördelning_kön')
colnames(data)
data$Fråga.4a.N.J
data$Fråga.4bN.J
which(is.na(data$Fråga.4a.N.J))
which(is.na(data$Fråga.4a.N.J)==T)
which(data$Fråga.4a.N.J=='na')
which(data$Fråga.4b.N.J=='na')
which(data$Fråga.4bN.J=='na')
data$Fråga.4a..Antal
which(data$Fråga.4a.N.J=='j')
which(data$Fråga.4bN.J=='j')
unique(c(which(data$Fråga.4a.N.J=='j'),which(data$Fråga.4bN.J=='j')))
data$tidigare_provtagning = FALSE
data$tidigare_provtagning[unique(c(which(data$Fråga.4a.N.J=='j'),which(data$Fråga.4bN.J=='j')))] = TRUE
data$tidigare_provtagning
CRP <- data[which(data$CRP),]
STREP <- data[which(data$STREP),]
ta <- table(data$tidigare_provtagning , data$Åldern)
ta
melt(ta)
ta_melted = melt(ta)
colnames(ta_melted) <- c( 'tidigare_provtagning', 'Åldern', 'value')
pl = ggplot(data=ta_melted, 
aes (x=Ålder, y=value, fill=tidigare_provtagning)
     ) +
geom_bar(stat="identity", color="black", position=position_dodge())+
theme_minimal()
pl = pl + xlab('Ålder') + ylab('patient [n]') + labs(fill = "tidigare provtagning")
pl
ta <- table(data$tidigare_provtagning , data$Åldern)
ta_melted = melt(ta)
colnames(ta_melted) <- c( 'tidigare_provtagning', 'Ålder', 'value')
pl = ggplot(data=ta_melted, 
aes (x=Ålder, y=value, fill=tidigare_provtagning)
     ) +
geom_bar(stat="identity", color="black", position=position_dodge())+
theme_minimal()
pl = pl + xlab('Ålder') + ylab('patient [n]') + labs(fill = "tidigare provtagning")
pl
pl + scale_fill_brewer(palette="Paired") 
ta
ta$NO_percent <- ta$'FALSE' / ( ta$'FALSE' +ta$'TRUE') *100
ta$NO_percent <- ta[1,] / ( ta[1,] +ta[,2]) *100
ta <- table(data$tidigare_provtagning , data$Åldern)
data.frame(ta)
table(data$tidigare_provtagning , data$Åldern)
colnames(ta)
roqnames(ta)
rownames(ta)
class(ta)
as.data.frame(ta)
ta[,3] <- ta[1,] / ( ta[1,] +ta[,2]) *100
ta[3,] <- ta[1,] / ( ta[1,] +ta[,2]) *100
ta[3,] <- ta[1,] / ( ta[1,] +ta[2,]) *100
as.matrix(ta)
as.data.frame(as.matrix(ta))
as.matrix(ta)
class(as.matrix(ta))
write.table(ta, file="tables/provtagning_age.tab", sep="\t",quote=F)
d <- read.delim("tables/provtagning_age.tab")
d
colnames(d) <- colnames(ta)
d
class(d)
ta$NO_percent <- ta[1,] / ( ta[1,] +ta[,2]) *100
d$NO_percent <- d[1,] / ( d[1,] +d[,2]) *100
d
d$NO_percent <- d[1,] / ( d[1,] +d[2,]) *100
d[1,] / ( d[1,] +d[2,]) *100
as.vector(d[1,] / ( d[1,] +d[2,]) *100)
as.vector(t(d[1,] / ( d[1,] +d[2,]) *100))
d$NO_percent <-as.vector(t(d[1,] / ( d[1,] +d[2,]) *100))
rbind(d, d[1,] / ( d[1,] +d[2,]) *100)
d = rbind(d, d[1,] / ( d[1,] +d[2,]) *100)
d = rbind(d, d[2,] / ( d[1,] +d[2,]) *100)
d
rownames(d) <- c('No','Yes', 'No [%]', 'Yes [%]' )
d
melt(d)
melt(d, id=rownames(d))
cbind( colnames(d), d)
cbind( rownames(d), d)
cbind( measure=rownames(d), d)
d = cbind( measure=rownames(d), d)
melt(d)
ta_melted = melt(d)
colnames(ta_melted) <- c( 'tidigare_provtagning', 'Ålder', 'value')
ta_melted
pl = ggplot(data=ta_melted, 
aes (x=Ålder, y=value, fill=tidigare_provtagning)
     ) +
geom_bar(stat="identity", color="black", position=position_dodge())+
theme_minimal()
pl = pl + xlab('Ålder') + ylab('patient [n]') + labs(fill = "tidigare provtagning")
pl
ta_melted = melt(d[c(3,4),])
ta_melted
colnames(ta_melted) <- c( 'tidigare_provtagning', 'Ålder', 'value')
pl = ggplot(data=ta_melted, 
aes (x=Ålder, y=value, fill=tidigare_provtagning)
     ) +
geom_bar(stat="identity", color="black", position=position_dodge())+
theme_minimal()
pl = pl + xlab('Ålder') + ylab('patient [n]') + labs(fill = "tidigare provtagning")
pl
pl = ggplot(data=ta_melted, 
aes (x=Ålder, y=value, fill=tidigare_provtagning)
     ) +
#geom_bar(stat="identity", color="black", position=position_dodge())+
geom_bar(stat="identity", color="black")+
theme_minimal()
pl = pl + xlab('Ålder') + ylab('patient [n]') + labs(fill = "tidigare provtagning")
pl
ta_melted = melt(d[,4:3])
colnames(ta_melted) <- c( 'tidigare_provtagning', 'Ålder', 'value')
pl = ggplot(data=ta_melted, 
aes (x=Ålder, y=value, fill=tidigare_provtagning)
     ) +
#geom_bar(stat="identity", color="black", position=position_dodge())+
geom_bar(stat="identity", color="black")+
theme_minimal()
pl = pl + xlab('Ålder') + ylab('patient [n]') + labs(fill = "tidigare provtagning")
pl
ta_melted
melt(d[,4:3])
d
melt(d[,4:3], ids=c('measure'))
melt(d[4:3,])
colnames(ta_melted) <- c( 'tidigare_provtagning', 'Ålder', 'value')
ta_melted = melt(d[4:3,])
colnames(ta_melted) <- c( 'tidigare_provtagning', 'Ålder', 'value')
pl = ggplot(data=ta_melted, 
aes (x=Ålder, y=value, fill=tidigare_provtagning)
     ) +
#geom_bar(stat="identity", color="black", position=position_dodge())+
geom_bar(stat="identity", color="black")+
theme_minimal()
pl = pl + xlab('Ålder') + ylab('patient [n]') + labs(fill = "tidigare provtagning")
pl
ta_melted
ta_melted[,1]
ta_melted[,1] <- factor( as.character(ta_melted[,1]), levels=c('Yes [%]','No [%]'))
pl = ggplot(data=ta_melted, 
aes (x=Ålder, y=value, fill=tidigare_provtagning)
     ) +
#geom_bar(stat="identity", color="black", position=position_dodge())+
geom_bar(stat="identity", color="black")+
theme_minimal()
pl = pl + xlab('Ålder') + ylab('patient [n]') + labs(fill = "tidigare provtagning")
pl
?scale_fill_brewer
pl = pl + scale_fill_manual(values=c('green','lightgray'))
pl
pl = ggplot(data=ta_melted, 
aes (x=Ålder, y=value, fill=tidigare_provtagning)
     ) +
geom_bar(stat="identity", color="black", position=position_dodge())+
#geom_bar(stat="identity", color="black")+
theme_minimal()
pl = pl + xlab('Ålder') + ylab('patient [n]') + labs(fill = "tidigare provtagning")
pl
pl_besides = pl
pl + geom_bar(stat="identity", color="black")
x11()
pl
pl
Plot(pl, 'Åldersfördelning_tidigare provtagning')
pl
pl = pl + xlab('Ålder') + ylab('patient [%]') + labs(fill = "tidigare provtagning")
Plot(pl, 'Åldersfördelning_tidigare provtagning')
ggplot(data, aes( Åldern, data.9 )) +geom_boxplot() +ylab('') +
scale_y_continuous(breaks=c(0,2,4,6,8, 10))
Plot(ggplot(data, aes( Åldern, data.9 )) +geom_boxplot() +ylab('') +
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_9_all' )
Plot(ggplot(CRP, aes( Åldern, data.9 )) +geom_boxplot() +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_9_CRP' )
Plot(ggplot(STREP, aes( Åldern, data.9 )) +geom_boxplot() +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_9_STREP' )
## question 10
Plot(ggplot(data, aes( Åldern, data.10 )) +geom_boxplot(na.rm = TRUE) +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_10_all' )
Plot(ggplot(CRP, aes( Åldern, data.10 )) +geom_boxplot() +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_10_CRP' )
Plot(ggplot(STREP, aes( Åldern, data.10 )) +geom_boxplot() +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_10_STREP' )
Plot = function (p, file ) {
pdf(file=paste("../figures/",file,'.pdf',sep=''), width=4, height=4)
print(p)
dev.off()
png(file=paste("../figures/",file,'.png',sep=''), width=600, height=600)
print(p)
dev.off()
}
Plot(ggplot(data, aes( Åldern, data.9 )) +geom_boxplot() +ylab('') +
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_9_all' )
Plot(ggplot(CRP, aes( Åldern, data.9 )) +geom_boxplot() +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_9_CRP' )
Plot(ggplot(STREP, aes( Åldern, data.9 )) +geom_boxplot() +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_9_STREP' )
## question 10
Plot(ggplot(data, aes( Åldern, data.10 )) +geom_boxplot(na.rm = TRUE) +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_10_all' )
Plot(ggplot(CRP, aes( Åldern, data.10 )) +geom_boxplot() +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_10_CRP' )
Plot(ggplot(STREP, aes( Åldern, data.10 )) +geom_boxplot() +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_10_STREP' )
colnames(data)
data$Fråga..8
Plot(ggplot(data, aes( Åldern, Fråga..8 )) +geom_boxplot(na.rm = TRUE) +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_8_all' )
Plot(ggplot(CRP, aes( Åldern, Fråga..8 )) +geom_boxplot() +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_8_CRP' )
Plot(ggplot(STREP, aes( Åldern, Fråga..8 )) +geom_boxplot() +ylab('')+
scale_y_continuous(breaks=c(0,2,4,6,8, 10)),
'Question_8_STREP' )
summary(data$tidigare_provtagning)
133/ (133+22) *100
t <- c( 0,0,0,0,1,1,5,9,10)
hist(t)
hist(t, breaks = 10)
mean (t)
median (t)
mad(t)
sd(t)
rnorm(2.888889, 4.075673, 100)
rnorm(100,2.888889, 4.075673)
x11()
hist(rnorm(100,2.888889, 4.075673))
summary(data)
save(data, file="data.RData")
summary(data)
summary(data)
92/155
86/155
86/156
133/156
q()
